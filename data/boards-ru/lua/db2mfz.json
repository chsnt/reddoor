{"subreddit":{"display_name":"lua"},"subreddit_loc":"принимать","selftext":"Здравствуйте, я знаю, что это не совсем чистый вопрос lua, так как он использует инфраструктуру Luvit (и также использует платформу бота Discordia), но, возможно, кто-то здесь использовал Luvit и имел некоторые идеи, или, возможно, моя проблема в Lua сторона вещей, и я просто пропускаю это. Но я чувствую, что я делал такие вещи раньше в Love2D (все еще не ванильный Lua, я знаю) и не имел никаких проблем.\n\nУ меня есть кусок кода, чтобы добавить пользователя для охлаждения таблицы отслеживания, затем создать таймер и настроить его на удаление пользователя из этой таблицы позже.\n\n    Функция triggerCooldown (член)\n      если не onCooldown (член) то\n        table.insert (ttsCoolDowns, member.id)\n        местный таймер = требуется («таймер»)\n        timer.setTimeout (ttsCooldownTime, removeFromCooldown, member)\n      конец\n    конец\n\nЭто прекрасно работает, работает стабильно в текущей версии моего бота в течение последнего года. Тем не менее, я недавно поработал над ботом и реорганизовал его в отдельные файлы, чтобы добавить больше функциональности. Моя проблема заключается в том, что перемещение этой функции в новый файл и последующее использование require () для запуска этого файла и определения того, что функция работает, но когда я вызываю функцию, вызов `local timer = require ('timer')` внутри нее завершается неудачно с Ошибка:\n\n    Неопределенная ошибка: ... ev / bots / johnbotman_main / JohnBotman / deps / coro-channel.lua: 62: ... an_main / JohnBotman / deps / discordia / libs / utils / Emitter.lua: 103:. \\ Cooldown.lua : 41: модуль «таймер» не найден:\n            нет поля package.preload ['timer']\n            нет файла '. \\ timer.lua'\n            нет файла 'D: \\ lib \\ lit \\ lua \\ timer.lua'\n            нет файла 'D: \\ lib \\ lit \\ lua \\ timer \\ init.lua'\n            нет файла. \\ timer.dll\n            нет файла 'D: \\ lib \\ lit \\ timer.dll'\n            нет файла 'D: \\ lib \\ lit \\ loadall.dll'\n    трассировка стека:\n            [C]: в функции «заявить»\n            ... ev / bots / johnbotman_main / JohnBotman / deps / coro-channel.lua: 62: в функции 'onPlain'\n            ... ohnbotman_main / JohnBotman / deps / secure-socket / biowrap.lua: 76: в функции <... ohnbotman_main / JohnBotman / deps / secure-socket / biowrap.lua: 61>\n            [C]: в функции «запустить»\n            [строка \"bundle: init.lua\"]: 52: в функции <[строка \"bundle: init.lua\"]: 47>\n            [C]: в функции 'xpcall'\n            [строка \"bundle: init.lua\"]: 47: в функции 'fn'\n            [строка \"bundle: deps / require.lua\"]: 310: в функции <[string \"bundle: deps / require.lua\"]: 266>\n\n В этом контексте 'timer' - это встроенный модуль Luvit, который снова подтвердил работу в основном файле lua, но не во вложенном файле. Я могу скопировать и вставить этот функциональный блок в основной файл, и он работает отлично, скопировать вставить его обратно, и он не удается. И это не значит, что я на самом деле не нуждаюсь в этом файле должным образом, таблица перезарядки, значение времени ожидания и две вспомогательные функции onCooldown () и removeFromCooldown () все еще в этом файле и вызываются и используются этой функцией, когда она в основном.\n\nЯ знаю, что могу просто оставить функцию в главном файле и продолжить разработку, но меня беспокоит, что мне придется это делать. Я не вижу причин, почему я не могу требовать модуль в любом другом файле, кроме основного ..","title":"Require ('timer') не работает в подфайле, когда он работает в основном файле","subreddit_name_prefixed":"r/lua","ups":2,"created":1569826545,"link_flair_background_color":"","id":"db2mfz","author":{"name":"Sialek"},"permalink":"/r/lua/comments/db2mfz/requiretimer_not_working_in_subfile_when_it_works/","url":"https://www.reddit.com/r/lua/comments/db2mfz/requiretimer_not_working_in_subfile_when_it_works/","created_utc":1569797745}