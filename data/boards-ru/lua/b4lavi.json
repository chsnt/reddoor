{"subreddit":{"display_name":"lua"},"subreddit_loc":"принимать","selftext":"Привет всем,\nЯ не программист lua, но я играл с clink и хотел создать «нечеткий» генератор совпадений с автозаполнением. Так и здесь.\n\nРЕДАКТИРОВАТЬ: [Здесь у вас есть Repl.it с основными функциями]  (https://repl.it/@crul/FuzzySearchTest) \n\nRE-EDIT: [Новая версия]  (https://repl.it/@crul/FuzzyTestSearchImproved)  на основе предложений / u / curtisf\n\nЭто не очень нечетко, но работает (код внизу). Исходя из заданного ввода (например, :) «rcwi», он соответствует любому файлу, который содержит эти инициалы в своих первых «словах», например, «run \\ _cmd \\ _with \\ _initials.bat», «run-cmd-with-initials-and» -more.exe \",\" выполнить cmd with ini.exe \"и т. д. В настоящее время поддерживаются разделители\"%. \",\"% s \",\" _ \",\" - \"и\" CamelCase \".\n\n~~ Прежде всего, ~~ Я хотел бы провести рефакторинг кода. Я уверен, что делаю много глупостей, особенно функции split (`get_initials`) и` concat`. Поэтому, пожалуйста, укажите на все ошибки или неправдоподобные вещи (спасибо!).\nК вашему сведению: у меня установлена ​​версия lua 5.2, я не знаю, могу ли я ее обновить.\n\n~~ В идеале я хотел бы поддержать также \"нечеткое соответствие\" CamelCase. В приведенном выше примере (\"rcwi\") он также будет соответствовать \"RunComandWithInitials\". Но я не знаю как. Любой ресурс и предложение будут приветствоваться! ~~\n\nРЕДАКТИРОВАТЬ: Готово! Это было легко, потребовалась только 1 строка: `text = text: gsub (\" (% u) \",\"% 1 \")`\n\nЕще раз спасибо.\n\n\n\nПолный код:\n\n    локальная функция fuzzy_match_generator (текст, первый, последний)\n        text = string.lower (text)\n        local curr_path = clink.get_cwd ()\n        локальные файлы = clink.find_files (curr_path)\n\n        local has_results = false\n        для _, файл в ipairs (файлы) сделать\n            если файл ~ = \".\" и файл ~ = \"..\" тогда\n                file_initials = get_initials (file, \"%.\")\n                initials = concat_str (file_initials, \"\")\n                сначала локально, _ = string.find (инициалы, текст)\n                если сначала == 1 то\n                    clink.add_match (файл)\n                    has_results = true\n                конец\n            конец\n        конец\n\n        возвращение has_results\n    конец\n\n    - адаптировано из этого http://www.wellho.net/resources/ex.php4?item=u105/spjo\n    функция get_initials (текст, разделитель)\n        text = text: gsub (\"(% u)\", \"% 1\")\n        text = text: gsub (\"-\", \".\")\n        text = text: gsub (\"_\", \".\")\n        text = text: gsub (\"\", \".\")\n\n        локальный список = {}; местный pos = 1\n        пока я делаю\n            сначала local, last = string.find (text, delimiter, pos)\n            если сначала то\n                word = string.sub (text, pos, first-1)\n                initial = string.sub (word, 1, 1)\n                если начальный то\n                    table.insert (список, string.lower (начальный))\n                конец\n                pos = последний + 1\n            еще\n                word = string.sub (text, pos)\n                initial = string.sub (word, 1, 1)\n                если начальный то\n                    table.insert (список, string.lower (начальный))\n                конец\n                перемена\n            конец\n        конец\n        список возврата\n    конец\n\n    функция concat_str (список, разделитель)\n        local len = #list\n        если len == 0 тогда\n            возвращение \"\"\n        конец\n        локальная строка = список [1]\n        для я = 2, лен до\n            строка = строка .. разделитель .. список [я]\n        конец\n        возвращаемая строка\n    конец\n    -------------------------------------------------- -------\n    clink.register_match_generator (fuzzy_match_generator, 1)","title":"Мой первый скрипт lua (\"нечеткий\" генератор совпадений для clink)","subreddit_name_prefixed":"r/lua","ups":4,"created":1553388528,"link_flair_background_color":"","id":"b4lavi","author":{"name":"Crul_"},"permalink":"/r/lua/comments/b4lavi/my_first_lua_script_fuzzy_match_generator_for/","url":"https://www.reddit.com/r/lua/comments/b4lavi/my_first_lua_script_fuzzy_match_generator_for/","created_utc":1553359728}